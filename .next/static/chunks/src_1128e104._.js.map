{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nabil/Downloads/hello-main/hello-main/src/lib/supabaseClient.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = 'https://fbbsameldccmlnxpugpn.supabase.co';\nconst supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZiYnNhbWVsZGNjbWxueHB1Z3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NDMyMTMsImV4cCI6MjA2NDUxOTIxM30.OLz7Xl3U41VA-jVXDwLDVOV0qG5ivwFcIF_uuCnL5M4';\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;AAAA;;AAEA,MAAM,cAAc;AACpB,MAAM,kBAAkB;AAEjB,MAAM,WAAW,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD,EAAE,aAAa","debugId":null}},
    {"offset": {"line": 24, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nabil/Downloads/hello-main/hello-main/src/app/dossiers/page.js"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { supabase } from '../../lib/supabaseClient';\nimport { useRouter } from 'next/navigation';\n\nexport default function DossiersPage() {\n  const router = useRouter();\n  const [user, setUser] = useState(null);\n  const [dossiers, setDossiers] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedDossier, setSelectedDossier] = useState(null);\n  const [passwordInput, setPasswordInput] = useState('');\n  const [error, setError] = useState('');\n  const [dossierOffres, setDossierOffres] = useState({});\n  const [showAddDossierForm, setShowAddDossierForm] = useState(false);\n  const [newDossier, setNewDossier] = useState({ nom: '', mot_de_passe: '' });\n\n  useEffect(() => {\n    const storedUser = JSON.parse(localStorage.getItem('user'));\n    if (storedUser) {\n      setUser(storedUser);\n    }\n    fetchDossiers();\n  }, []);\n\n  const fetchDossiers = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('dossiers')\n        .select('*')\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      setDossiers(data || []);\n\n      // R√©cup√©rer les offres pour chaque dossier\n      const offresPromises = data.map(async (dossier) => {\n        const { data: offresData, error: offresError } = await supabase\n          .from('dossier_offres')\n          .select(`\n            offre_id,\n            offres (\n              id,\n              poste,\n              entreprise,\n              localisation,\n              duree,\n              lien,\n              created_at\n            )\n          `)\n          .eq('dossier_id', dossier.id);\n\n        if (offresError) throw offresError;\n        return { dossierId: dossier.id, offres: offresData.map(d => d.offres) };\n      });\n\n      const offresResults = await Promise.all(offresPromises);\n      const offresMap = offresResults.reduce((acc, { dossierId, offres }) => {\n        acc[dossierId] = offres;\n        return acc;\n      }, {});\n      setDossierOffres(offresMap);\n    } catch (error) {\n      console.error('Erreur lors de la r√©cup√©ration des dossiers:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAccess = async (dossier) => {\n    if (user?.role === 'admin') {\n      router.push(`/mes-candidatures?dossier_id=${dossier.id}`);\n      return;\n    }\n\n    // Si le dossier n'a pas de mot de passe, acc√®s direct\n    if (!dossier.mot_de_passe) {\n      router.push(`/mes-candidatures?dossier_id=${dossier.id}`);\n      return;\n    }\n\n    setSelectedDossier(dossier);\n    setPasswordInput('');\n    setError('');\n  };\n\n  const handlePasswordSubmit = async (e) => {\n    e.preventDefault();\n    \n    try {\n      // V√©rifier le mot de passe\n      const { data, error } = await supabase\n        .from('dossiers')\n        .select('*')\n        .eq('id', selectedDossier.id)\n        .eq('mot_de_passe', passwordInput)\n        .single();\n\n      if (error) throw error;\n\n      if (data) {\n        // Mot de passe correct, rediriger vers le dossier\n        router.push(`/mes-candidatures?dossier_id=${selectedDossier.id}`);\n      } else {\n        setError('Mot de passe incorrect');\n      }\n    } catch (error) {\n      console.error('Erreur lors de la v√©rification du mot de passe:', error);\n      setError('Une erreur est survenue');\n    }\n  };\n\n  const handleAddDossier = async () => {\n    const { nom, mot_de_passe } = newDossier;\n    if (!nom) return alert('Le nom du dossier est requis.');\n    \n    try {\n      const { data, error } = await supabase\n        .from('dossiers')\n        .insert([{ \n          nom, \n          mot_de_passe: mot_de_passe || null,\n          user_id: user.id \n        }])\n        .select();\n\n      if (error) throw error;\n\n      setDossiers([...dossiers, data[0]]);\n      setNewDossier({ nom: '', mot_de_passe: '' });\n      setShowAddDossierForm(false);\n    } catch (error) {\n      console.error('Erreur lors de la cr√©ation du dossier:', error);\n      alert('Erreur lors de la cr√©ation du dossier');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-900 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-900 text-white\">\n      {/* Main content */}\n      <div className=\"p-10\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h2 className=\"text-2xl font-bold\">üìÅ Dossiers de candidatures</h2>\n          <button\n            onClick={() => setShowAddDossierForm(!showAddDossierForm)}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded-full font-bold shadow transition-all duration-200 hover:scale-105 hover:shadow-lg hover:-translate-y-0.5 text-xs\"\n          >\n            {showAddDossierForm ? 'Annuler' : 'Cr√©er un dossier'}\n          </button>\n        </div>\n\n        {showAddDossierForm && (\n          <div className=\"bg-gray-800 rounded-xl p-6 mb-8 border border-gray-700\">\n            <h3 className=\"text-xl font-semibold mb-4\">Nouveau dossier</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n                  Nom du dossier\n                </label>\n                <input\n                  type=\"text\"\n                  value={newDossier.nom}\n                  onChange={(e) => setNewDossier({ ...newDossier, nom: e.target.value })}\n                  className=\"w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none\"\n                  placeholder=\"Ex: Recherche emploi 2024\"\n                  required\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-300 mb-2\">\n                  Mot de passe (optionnel)\n                </label>\n                <input\n                  type=\"password\"\n                  value={newDossier.mot_de_passe}\n                  onChange={(e) => setNewDossier({ ...newDossier, mot_de_passe: e.target.value })}\n                  className=\"w-full p-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none\"\n                  placeholder=\"Laissez vide pour un acc√®s sans mot de passe\"\n                />\n              </div>\n              <button\n                onClick={handleAddDossier}\n                className=\"bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded-full font-bold shadow transition-all duration-200 hover:scale-105 hover:shadow-lg hover:-translate-y-0.5 text-xs\"\n              >\n                Cr√©er le dossier\n              </button>\n            </div>\n          </div>\n        )}\n\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n          {dossiers.map((dossier) => (\n            <div key={dossier.id} className=\"bg-gray-800 rounded-xl p-6 border border-gray-700\">\n              <h3 className=\"text-xl font-semibold mb-2\">{dossier.nom}</h3>\n              <p className=\"text-gray-400 text-sm mb-2\">\n                Cr√©√© le {new Date(dossier.created_at).toLocaleDateString()}\n              </p>\n              \n              {/* Afficher les offres du dossier */}\n              {dossierOffres[dossier.id]?.length > 0 && (\n                <div className=\"mb-4\">\n                  <h4 className=\"text-sm font-semibold text-gray-300 mb-2\">Offres lik√©es :</h4>\n                  <div className=\"space-y-2\">\n                    {dossierOffres[dossier.id].map((offre) => (\n                      <div key={offre.id} className=\"bg-gray-700 rounded p-2 text-sm\">\n                        <p className=\"font-medium\">{offre.poste}</p>\n                        <p className=\"text-gray-400\">{offre.entreprise}</p>\n                        {offre.lien && (\n                          <a\n                            href={offre.lien}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"text-blue-400 hover:underline text-xs\"\n                          >\n                            Voir l'offre\n                          </a>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              <button\n                onClick={() => handleAccess(dossier)}\n                className=\"w-full bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded-full font-bold shadow transition-all duration-200 hover:scale-105 hover:shadow-lg hover:-translate-y-0.5 text-xs\"\n              >\n                {user?.role === 'admin' ? 'Acc√©der' : 'Ouvrir'}\n              </button>\n            </div>\n          ))}\n        </div>\n\n        {selectedDossier && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\">\n            <div className=\"bg-gray-800 p-6 rounded-xl w-96\">\n              <h3 className=\"text-xl font-semibold mb-4\">Acc√©der √† {selectedDossier.nom}</h3>\n              <form onSubmit={handlePasswordSubmit} className=\"space-y-4\">\n                <input\n                  type=\"password\"\n                  placeholder=\"Mot de passe\"\n                  className=\"w-full bg-gray-700 border border-gray-600 text-white px-3 py-2 rounded\"\n                  value={passwordInput}\n                  onChange={(e) => setPasswordInput(e.target.value)}\n                />\n                {error && <div className=\"text-red-400 text-sm\">{error}</div>}\n                <div className=\"flex gap-3\">\n                  <button\n                    type=\"submit\"\n                    className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded-full font-bold shadow transition-all duration-200 hover:scale-105 hover:shadow-lg hover:-translate-y-0.5 text-xs\"\n                  >\n                    Acc√©der\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => setSelectedDossier(null)}\n                    className=\"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded-full font-bold shadow transition-all duration-200 hover:scale-105 hover:shadow-lg hover:-translate-y-0.5 text-xs\"\n                  >\n                    Annuler\n                  </button>\n                </div>\n              </form>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}